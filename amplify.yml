version: 1
frontend:
  phases:
    preBuild:
      commands:
        - |
          if [ "$AWS_BRANCH" = "main" ]; then
            cd infinosfrontend
          else
            cd infinosfrontend-admin
          fi
        - npm install
    build:
      commands:
        - npm run build
  artifacts:
    baseDirectory: |
      $([[ "$AWS_BRANCH" = "main" ]] && echo "infinosfrontend/build" || echo "infinosfrontend-admin/build")
    files:
      - '**/*'
  cache:
    paths:
      - |
        $([[ "$AWS_BRANCH" = "main" ]] && echo "infinosfrontend/node_modules/**/*" || echo "infinosfrontend-admin/node_modules/**/*")